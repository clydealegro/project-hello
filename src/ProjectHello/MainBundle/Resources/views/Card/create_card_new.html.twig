{% extends 'ProjectHelloMainBundle:Default:create_card_new.html.twig' %}

{% set create_card_action = path('create_card') %}

{% block creator_name_field %}
    {{ forms.fieldRow(form.creatorName, 'Creator Name') }}
{% endblock %}

{% block recipient_name_field %}
    {{ forms.fieldRow(form.recipientName, 'Recipient Name') }}
{% endblock %}

{% block recipient_email_field %}
    {{ forms.fieldRow(form.recipientEmailAddress, 'Recipient Email') }}
{% endblock %}

{% block creator_message_field %}
    {{ forms.fieldRow(form.message, 'Creator Message', 'input-xlarge') }}
{% endblock %}

{% block collaborator_field %}
    {{ forms.fieldGroupCollection(form.collaborators, 'ProjectHelloMainBundle:Fragments:collaborator_field_new.html.twig') }}
{% endblock %}

{% block instruction_field %}
    {{ forms.fieldRow(form.instruction, 'Instructions', 'input-xlarge') }}
{% endblock %}

{% block sending_date_field %}
    {{ forms.fieldRow(form.sendingDate, 'Sending Date') }}
{% endblock %}

{% block hidden_fields %}
    {{ form_widget(form._token) }}
{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <script type="text/javascript">
    (function($){
    	$('#dp3').datepicker({
            format: 'mm-dd-yyyy'
        });
        
        function removeCollaborator($el, e) {
        	e.preventDefault();
        	
        	$el.parent().remove();
        	return false;
        }
        
        $(function(){
        	if ($('.collaborator').index() < 2) {
        		$('.remove-collaborator-btn').hide();
        	}
        	
            $('.remove-collaborator-btn').click(function(e){
            	removeCollaborator($(this), e);
            })
            
            $('#add-collaborator-btn').click(function(e){
            	e.preventDefault();
            	
            	var $newCollaborator = $('.collaborator:last').clone();
            	$newCollaborator.find('.remove-collaborator-btn').show().bind('click', function(e){
            		removeCollaborator($(this), e);
            	});
		    	$newCollaborator.find('input[id^=card_collaborators]').attr('value', '');
            	$('.collaborator:last').after($newCollaborator);
		        return false;
            });
        });
    })(jQuery);
    </script>
{% endblock %}